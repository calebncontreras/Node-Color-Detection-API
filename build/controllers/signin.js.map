{"version":3,"sources":["../../src/controllers/signin.js"],"names":["handleSignin","req","res","db","bcrypt","body","email","password","select","from","where","then","data","isValid","compareSync","hash","console","log","user","json","err","status"],"mappings":";;;;;;;AAAO,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAWC,EAAX,EAAeC,MAAf,EAA0B;AAAA,kBACxBH,GAAG,CAACI,IADoB;AAAA,MAC5CC,KAD4C,aAC5CA,KAD4C;AAAA,MACrCC,QADqC,aACrCA,QADqC;AAEpDJ,EAAAA,EAAE,CAACK,MAAH,CAAU,OAAV,EAAmB,MAAnB,EACGC,IADH,CACQ,OADR,EAEGC,KAFH,CAES,OAFT,EAEkB,GAFlB,EAEuBJ,KAFvB,EAGGK,IAHH,CAGQ,UAACC,IAAD,EAAU;AACd,QAAMC,OAAO,GAAGT,MAAM,CAACU,WAAP,CAAmBP,QAAnB,EAA6BK,IAAI,CAAC,CAAD,CAAJ,CAAQG,IAArC,CAAhB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAZ;;AACA,QAAIA,OAAJ,EAAa;AACX,aAAOV,EAAE,CACNK,MADI,CACG,GADH,EAEJC,IAFI,CAEC,OAFD,EAGJC,KAHI,CAGE,OAHF,EAGW,GAHX,EAGgBJ,KAHhB,EAIJK,IAJI,CAIC,UAACO,IAAD,EAAU;AACdhB,QAAAA,GAAG,CAACiB,IAAJ,CAASD,IAAI,CAAC,CAAD,CAAb;AACD,OANI,WAOE,UAACE,GAAD;AAAA,eAASlB,GAAG,CAACmB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB,oBAArB,CAAT;AAAA,OAPF,CAAP;AAQD,KATD,MASO;AACLjB,MAAAA,GAAG,CAACmB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB,qBAArB;AACD;AACF,GAlBH,WAmBS,UAACC,GAAD;AAAA,WAASlB,GAAG,CAACmB,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB,qBAArB,CAAT;AAAA,GAnBT;AAoBD,CAtBM","sourcesContent":["export const handleSignin = (req, res, db, bcrypt) => {\r\n  const { email, password } = req.body;\r\n  db.select(\"email\", \"hash\")\r\n    .from(\"login\")\r\n    .where(\"email\", \"=\", email)\r\n    .then((data) => {\r\n      const isValid = bcrypt.compareSync(password, data[0].hash);\r\n      console.log(isValid);\r\n      if (isValid) {\r\n        return db\r\n          .select(\"*\")\r\n          .from(\"users\")\r\n          .where(\"email\", \"=\", email)\r\n          .then((user) => {\r\n            res.json(user[0]);\r\n          })\r\n          .catch((err) => res.status(400).json(\"unable to get user\"));\r\n      } else {\r\n        res.status(404).json(\"invalid credentials\");\r\n      }\r\n    })\r\n    .catch((err) => res.status(404).json(\"invalid credentials\"));\r\n};\r\n"],"file":"signin.js"}